<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1a1514"> <title>POMELLI | Estate Provisions</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,400;1,600&family=Monsieur+La+Doulaise&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <style>
        /* ==========================================================================
           1. THE ESTATE DESIGN SYSTEM
           ========================================================================== */
        :root {
            /* --- COLOR PALETTE: "Blood & Gold" --- */
            --cherry-deep: #5e0b15;       /* Primary Action Color */
            --cherry-wash: rgba(94, 11, 21, 0.05);
            
            --walnut-ink: #1F1B1A;        /* Primary Text */
            --walnut-light: #4A403A;      /* Secondary Text */
            
            --gold-antique: #C5A059;      /* Borders */
            --gold-leaf: #D4AF37;         /* Accents */
            
            --cream-paper: #F9F8F4;       /* Background */
            --white-wash: rgba(255, 255, 255, 0.9);

            /* --- TYPOGRAPHY --- */
            --f-display: 'Cinzel', serif;
            --f-body: 'Cormorant Garamond', serif;
            --f-script: 'Monsieur La Doulaise', cursive;

            /* --- PHYSICS & EFFECTS --- */
            --shadow-card: 0 15px 40px rgba(31, 27, 26, 0.08);
            --shadow-float: 0 20px 60px rgba(0,0,0,0.15);
            --ease-luxury: cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        /* RESET */
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        
        html { scroll-behavior: smooth; }
        
        body {
            background-color: var(--cream-paper);
            color: var(--walnut-ink);
            font-family: var(--f-body);
            overflow-x: hidden;
            font-size: 18px; /* Readable Base Size */
            padding-bottom: 100px; /* Space for UI controls */
            
            /* The Grain Texture */
            background-image: url("https://www.transparenttextures.com/patterns/cream-paper.png");
            background-blend-mode: multiply;
        }

        img { width: 100%; display: block; object-fit: cover; }
        
        /* Smooth Fade In */
        body { opacity: 0; animation: dawnRise 1.5s ease forwards; }
        @keyframes dawnRise { to { opacity: 1; } }


        /* ==========================================================================
           2. THE IRON GATES (Preloader)
           ========================================================================== */
        #estate-gate {
            position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
            background: #120e0d; z-index: 9999;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: transform 1.2s var(--ease-luxury);
        }
        
        #estate-gate.open { transform: translateY(-100%); pointer-events: none; }

        .gate-logo { 
            width: 140px; opacity: 0; filter: invert(1);
            animation: fadeInLogo 1s 0.2s forwards; margin-bottom: 40px;
        }

        .enter-btn {
            background: transparent; border: 1px solid var(--gold-leaf);
            color: var(--gold-leaf); font-family: var(--f-display);
            padding: 18px 50px; font-size: 0.9rem; letter-spacing: 4px;
            text-transform: uppercase; cursor: pointer; position: relative; overflow: hidden;
            opacity: 0; animation: fadeInLogo 1s 0.8s forwards; transition: 0.3s;
        }
        .enter-btn:active { background: var(--gold-leaf); color: #000; }

        @keyframes fadeInLogo { from{opacity:0; transform:translateY(10px);} to{opacity:1; transform:translateY(0);} }


        /* ==========================================================================
           3. THE NAVIGATION (Sticky, Frosted)
           ========================================================================== */
        .manor-nav {
            position: fixed; top: 0; left: 0; width: 100%; height: 75px;
            background: rgba(249, 248, 244, 0.95);
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(197, 160, 89, 0.2);
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 25px; z-index: 5000;
            transition: top 0.3s;
        }

        /* --- LOGO SIZE FIX --- */
        .logo-wrap {
            height: 100%; flex: 1; display: flex; 
            align-items: center; justify-content: center;
        }
        
        .nav-logo {
            height: 42px; /* Fixed Height Constraints */
            width: auto; 
            max-width: 180px; 
            object-fit: contain; 
            mix-blend-mode: multiply; /* Blends perfectly with cream */
        }

        /* NAV ICONS */
        .nav-action {
            flex: 0 0 40px; display: flex; align-items: center; justify-content: center;
            font-size: 1.4rem; color: var(--walnut-ink); cursor: pointer;
        }

        /* CART BADGE */
        .cart-badge {
            position: absolute; top: -6px; right: -6px;
            background: var(--cherry-deep); color: white;
            font-family: var(--f-display); font-size: 0.6rem;
            width: 18px; height: 18px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            opacity: 0; transform: scale(0); transition: 0.3s cubic-bezier(0.5, -0.5, 0.5, 1.5);
        }
        .cart-badge.active { opacity: 1; transform: scale(1); }


        /* ==========================================================================
           4. CINEMATIC HEADER
           ========================================================================== */
        .cinema-frame {
            position: relative; height: 60vh; width: 100%;
            margin-top: 75px; overflow: hidden;
            border-radius: 0 0 30px 30px;
            box-shadow: 0 20px 50px -10px rgba(0,0,0,0.3);
            background: #2a1b18; /* Loader color */
        }

        .cinema-video {
            width: 100%; height: 100%; object-fit: cover;
            filter: brightness(0.65) contrast(1.1) sepia(0.1);
            transform: scale(1.05); /* Slight zoom for quality */
        }

        .cinema-overlay {
            position: absolute; bottom: 40px; left: 0; width: 100%;
            padding: 0 30px; z-index: 10;
        }

        .cinema-script {
            font-family: var(--f-script); color: var(--gold-leaf);
            font-size: 3.5rem; line-height: 0.4;
            text-shadow: 0 2px 10px rgba(0,0,0,0.8);
        }

        .cinema-title {
            font-family: var(--f-display); color: #fff;
            font-size: 2.2rem; letter-spacing: 1px;
            text-transform: uppercase; margin-top: 15px;
            text-shadow: 0 4px 20px rgba(0,0,0,0.9);
        }


        /* ==========================================================================
           5. INTERACTIVE TABS
           ========================================================================== */
        .tab-scroller {
            position: sticky; top: 75px; 
            background: var(--cream-paper); z-index: 4000;
            padding: 15px 0; border-bottom: 1px solid rgba(0,0,0,0.05);
            /* Scroll handling */
            white-space: nowrap; overflow-x: auto; -ms-overflow-style: none; scrollbar-width: none;
        }
        .tab-scroller::-webkit-scrollbar { display: none; }

        .tab-track { padding: 0 20px; display: inline-flex; gap: 12px; }

        .tab-btn {
            background: rgba(230, 226, 216, 0.6); 
            padding: 10px 24px; border-radius: 50px; border: 1px solid transparent;
            font-family: var(--f-display); font-size: 0.8rem; letter-spacing: 1px;
            color: #777; cursor: pointer; transition: all 0.3s ease;
        }

        .tab-btn.active {
            background: var(--walnut-ink); color: var(--gold-leaf);
            border-color: var(--walnut-ink);
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        }


        /* ==========================================================================
           6. CONTENT CARDS (The Collection)
           ========================================================================== */
        .section-view { display: none; padding: 25px 20px; min-height: 60vh; }
        .section-view.active { display: block; animation: sectionSlideUp 0.6s var(--ease-luxury); }
        @keyframes sectionSlideUp { from {opacity:0; transform:translateY(30px);} to {opacity:1; transform:translateY(0);} }

        .estate-card {
            background: #fff; border-radius: 12px; margin-bottom: 40px;
            box-shadow: var(--shadow-card);
            position: relative; overflow: hidden;
            border: 1px solid rgba(0,0,0,0.04);
            transform: translateZ(0); transition: transform 0.2s;
        }
        .estate-card:active { transform: scale(0.98); }

        .card-img-frame {
            height: 320px; position: relative; overflow: hidden;
        }
        
        .card-img { width: 100%; height: 100%; object-fit: cover; }

        /* The Price Tag */
        .price-badge {
            position: absolute; top: 20px; right: 20px;
            background: rgba(255,255,255,0.95); backdrop-filter: blur(10px);
            padding: 8px 16px; border-radius: 4px;
            font-family: var(--f-display); font-weight: 700; color: var(--cherry-deep);
            border: 1px solid var(--gold-antique);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .card-details { padding: 30px 25px; text-align: center; }

        .card-title {
            font-family: var(--f-display); font-size: 1.5rem; 
            margin-bottom: 10px; color: var(--walnut-ink);
        }

        .card-preview {
            font-size: 1.1rem; line-height: 1.6; color: var(--walnut-light); 
            margin-bottom: 25px; font-style: italic;
        }

        .btn-interact {
            width: 100%; padding: 16px; background: transparent;
            color: var(--walnut-ink); border: 1px solid var(--gold-antique);
            font-family: var(--f-display); text-transform: uppercase; 
            letter-spacing: 2px; font-size: 0.8rem; border-radius: 4px;
            cursor: pointer; transition: 0.2s;
        }
        .btn-interact:hover, .btn-interact:active {
            background: var(--walnut-ink); color: var(--gold-leaf); border-color: var(--walnut-ink);
        }


        /* ==========================================================================
           7. VISUAL MODULES (Watercolors & Quotes)
           ========================================================================== */
        .story-breaker {
            margin: 50px -20px; /* Bleed Edge */
            padding: 60px 30px;
            background-image: url('packaging-watercolor-woodland-art.jpg');
            background-size: cover; background-position: center;
            text-align: center; border-top: 5px solid white; border-bottom: 5px solid white;
            box-shadow: inset 0 0 100px rgba(0,0,0,0.1);
        }

        .story-text-box {
            background: rgba(255,255,255,0.95); display: inline-block; padding: 25px 40px;
            border: 1px solid var(--gold-antique); box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .story-text-box h3 { font-family: var(--f-display); margin-bottom: 5px; color: var(--cherry-deep); }


        /* ==========================================================================
           8. FORMS (Butler Service)
           ========================================================================== */
        .form-card {
            background: #fff; padding: 40px 25px;
            border-radius: 16px; margin-top: -30px; z-index: 5; position: relative;
            box-shadow: 0 20px 60px rgba(0,0,0,0.08);
        }

        .form-row { margin-bottom: 25px; }
        .lbl {
            display: block; font-family: var(--f-display); 
            font-size: 0.75rem; letter-spacing: 2px; color: #888; 
            text-transform: uppercase; margin-bottom: 10px;
        }
        .inp {
            width: 100%; padding: 15px; border: 1px solid #ddd; border-radius: 4px;
            font-family: var(--f-body); font-size: 1.1rem; color: #333;
            background: #fafafa; transition: border 0.3s;
        }
        .inp:focus { border-color: var(--cherry-deep); background: white; }
        
        select.inp {
            appearance: none; background: white url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23b08d55%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E') no-repeat right 15px center;
            background-size: 10px;
        }


        /* ==========================================================================
           9. THE ARCHIVE MODAL (Detail Sheet)
           ========================================================================== */
        .modal-screen {
            position: fixed; inset: 0; background: rgba(34, 26, 25, 0.6); backdrop-filter: blur(5px);
            z-index: 6000; opacity: 0; pointer-events: none; transition: 0.4s;
        }
        .modal-screen.active { opacity: 1; pointer-events: auto; }

        .archive-sheet {
            position: fixed; bottom: 0; left: 0; width: 100%; height: 90vh;
            background: #FFF; border-radius: 20px 20px 0 0; z-index: 6100;
            transform: translateY(100%); transition: transform 0.5s var(--ease-luxury);
            overflow-y: scroll; padding-bottom: 120px;
            /* Inner texture */
            background-image: url("https://www.transparenttextures.com/patterns/cream-paper.png");
        }
        .archive-sheet.active { transform: translateY(0); }

        .close-circle {
            position: absolute; top: 20px; right: 20px; width: 40px; height: 40px;
            background: white; border-radius: 50%; box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: flex; align-items: center; justify-content: center; z-index: 100;
            color: var(--walnut-ink); transition: 0.3s;
        }
        .close-circle:hover { transform: rotate(90deg); color: var(--cherry-deep); }

        .hero-img-detail { height: 400px; width: 100%; object-fit: cover; }

        .module-block { padding: 40px 25px; }

        /* Specs Grid */
        .spec-grid {
            display: flex; border: 1px solid var(--gold-antique); margin: 30px 0;
            border-radius: 8px; overflow: hidden;
        }
        .spec-item {
            flex: 1; text-align: center; padding: 15px 5px;
            border-right: 1px solid var(--gold-antique); background: #faf8f5;
        }
        .spec-item:last-child { border: none; }
        .spec-label { font-size: 0.6rem; text-transform: uppercase; color: #888; letter-spacing: 1px; display: block; margin-bottom: 5px; }
        .spec-val { font-family: var(--f-display); font-size: 1.1rem; color: var(--walnut-ink); }

        /* The Notes Paper Effect */
        .notes-paper {
            margin: 30px -10px; padding: 30px;
            background: #fff; border: 1px solid #eee;
            box-shadow: inset 0 0 40px rgba(0,0,0,0.02);
            font-size: 1.05rem; line-height: 1.8;
        }
        
        .ingredient-list li { margin-bottom: 8px; border-bottom: 1px dashed #e0e0e0; padding-bottom: 8px; list-style: none; }
        
        .method-step { display: flex; gap: 15px; margin-bottom: 20px; }
        .step-num { 
            flex: 0 0 25px; height: 25px; background: var(--cherry-deep); color: white;
            font-family: var(--f-display); border-radius: 50%; font-size: 0.8rem;
            display: flex; align-items: center; justify-content: center; 
        }

        /* The Action Shot Embed */
        .interaction-img {
            margin: 30px 0; border: 8px solid white; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.1); 
            transform: rotate(-1deg);
        }

        /* Floating Add Button */
        .add-action-bar {
            position: fixed; bottom: 0; left: 0; width: 100%;
            padding: 20px; background: rgba(255,255,255,0.9);
            border-top: 1px solid rgba(0,0,0,0.05); z-index: 6200;
            display: none; animation: floatUpBtn 0.4s ease;
        }
        .add-action-bar.active { display: block; }
        @keyframes floatUpBtn { from{transform:translateY(100%);} to{transform:translateY(0);} }

        .btn-add {
            width: 100%; padding: 18px; border-radius: 4px; border: none;
            background: var(--cherry-deep); color: white;
            font-family: var(--f-display); letter-spacing: 2px; text-transform: uppercase;
            box-shadow: 0 10px 30px rgba(138, 28, 40, 0.4);
        }


        /* ==========================================================================
           10. THE TRUNK (Side Drawer)
           ========================================================================== */
        .drawer {
            position: fixed; top: 0; right: 0; width: 100%; height: 100%;
            background: #FDFBF7; z-index: 7000;
            transform: translateX(100%); transition: transform 0.5s var(--ease-luxury);
            display: flex; flex-direction: column;
            box-shadow: -20px 0 100px rgba(0,0,0,0.3);
        }
        .drawer.open { transform: translateX(0); }

        .drawer-header {
            padding: 25px; border-bottom: 1px solid rgba(0,0,0,0.05);
            display: flex; justify-content: space-between; align-items: center;
            background: white;
        }
        
        .drawer-content { flex: 1; padding: 25px; overflow-y: auto; }
        
        .cart-item-row {
            padding-bottom: 15px; margin-bottom: 15px; border-bottom: 1px dashed #ccc;
            display: flex; justify-content: space-between; align-items: center;
        }

        .drawer-footer {
            background: white; padding: 30px 25px 50px;
            border-top: 1px solid rgba(0,0,0,0.05);
        }


        /* ==========================================================================
           11. FOOTER
           ========================================================================== */
        .site-footer {
            background: #111; color: #777; padding: 60px 20px; text-align: center;
        }
        .footer-logo { font-family: var(--f-script); color: var(--gold-antique); font-size: 2.5rem; margin-bottom: 10px;}
        .footer-line { width: 50px; height: 1px; background: #333; margin: 20px auto; }
        .legal { font-size: 0.7rem; letter-spacing: 1px; text-transform: uppercase; margin-top: 30px; opacity: 0.5; }

    </style>
</head>
<body>

    <div id="estate-gate" onclick="enterManor()">
        <img src="pomelli-vintage-logo-script.jpg" class="gate-logo" alt="P">
        <button class="enter-btn">Enter The Estate</button>
    </div>


    <header class="manor-nav">
        <div class="nav-action">
            <i class="fa-solid fa-bars" onclick="alert('The Butler is preparing the full archive.')"></i>
        </div>
        
        <div class="logo-wrap">
            <img src="pomelli-vintage-logo-script.jpg" class="nav-logo" alt="Pomelli Estate" onerror="this.style.display='none'">
        </div>

        <div class="nav-action cart-wrapper" onclick="toggleCart()">
            <i class="fa-solid fa-suitcase"></i>
            <div class="cart-badge" id="cart-count">0</div>
        </div>
    </header>


    <div class="cinema-frame">
        <video id="bg-video" class="cinema-video" muted loop playsinline webkit-playsinline preload="auto" poster="https://via.placeholder.com/1000x1000?text=Loading+Estate">
            <source src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/asembeling%20carrot%20cake%20video.mp4" type="video/mp4">
        </video>
        <div class="cinema-overlay">
            <span class="cinema-script">High Society</span>
            <h1 class="cinema-title">Winter Provisions</h1>
        </div>
    </div>


    <div class="tab-scroller">
        <div class="tab-track">
            <button class="tab-btn active" onclick="switchSection('cakes', this)">Grand Gâteaux</button>
            <button class="tab-btn" onclick="switchSection('buns', this)">Morning Goods</button>
            <button class="tab-btn" onclick="switchSection('concierge', this)">Butler Service</button>
        </div>
    </div>


    <section id="cakes" class="section-view active">
        <div class="estate-card">
            <div class="card-img-frame">
                <div class="price-badge">1250 EGP</div>
                <img src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/sovereign-carrot-cake-whole.jpg" class="card-img" alt="Carrot Cake">
            </div>
            <div class="card-details">
                <h2 class="card-title">The Sovereign Gâteau</h2>
                <p class="card-preview">A recipe guarded within the archives. Dense heritage sponge, candied pecans, and brown butter.</p>
                <button class="btn-interact" onclick="showCarrotDetails()">Access Archive Entry</button>
            </div>
        </div>

        <div class="estate-card">
            <div class="card-img-frame">
                <div class="price-badge">140 EGP</div>
                <img src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/carrot-cake-slice-art-deco-plate.jpg" class="card-img" alt="Slice">
            </div>
            <div class="card-details">
                <h2 class="card-title">The Salon Slice</h2>
                <p class="card-preview">Gold-standard individual portion. For the private study or afternoon tea.</p>
                <button class="btn-interact" onclick="addToCart('Salon Slice', 140)">Add Single Portion</button>
            </div>
        </div>
    </section>


    <section id="buns" class="section-view">
        <div class="estate-card">
            <div class="card-img-frame">
                <div class="price-badge">850 EGP</div>
                <img src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/Flow%20Dec%2031%202025.jpeg" class="card-img" alt="Sticky Buns">
            </div>
            <div class="card-details">
                <h2 class="card-title">Caramel Pecan Sticky Buns</h2>
                <p class="card-preview">The ultimate holiday provision. 12 brioche spirals bathing in a bed of boiling caramel.</p>
                <button class="btn-interact" onclick="showBunDetails()">View The Romance</button>
            </div>
        </div>

        <div class="estate-card">
            <div class="card-img-frame">
                <div class="price-badge">450 EGP</div>
                <img src="topview.png" class="card-img" alt="Estate Sourdough"> 
            </div>
            <div class="card-details">
                <h2 class="card-title">The Estate Sourdough</h2>
                <p class="card-preview">Crust of iron, heart of velvet. Wild-fermented with 100% Italian flour and the Butler's starter.</p>
                <button class="btn-interact" onclick="showSourdoughDetails()">Inspect The Loaf</button>
            </div>
        </div>

        <div class="story-breaker">
            <div class="story-text-box">
                <h3>The Folklore</h3>
                <p style="font-style: italic; color:#555;">No plastic. Arrives in Beatrix Potter boxes.</p>
            </div>
        </div>
    </section>


    <section id="concierge" class="section-view">
        <img src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/butler-service-caramel-drip.jpg" style="border-radius:12px; margin-bottom:20px; filter:sepia(0.2);">
        
        <div class="form-card">
            <h2 class="card-title">Commission The Butler</h2>
            <p style="text-align:center; color:#888; font-size:0.9rem; margin-bottom:30px;">Request "Service à la Russe" tableside plating.</p>
            
            <div class="form-row">
                <label class="lbl">Client Title & Name</label>
                <input type="text" class="inp" id="req-name">
            </div>
            
            <div class="form-row">
                <label class="lbl">Estate District</label>
                <select class="inp" id="req-zone">
                    <option>Zamalek</option>
                    <option>Maadi</option>
                    <option>New Cairo</option>
                    <option>Garden City</option>
                    <option>Sheikh Zayed</option>
                </select>
            </div>
            
            <div class="form-row">
                <label class="lbl">Requests</label>
                <textarea class="inp" id="req-details" placeholder="Describe the affair..."></textarea>
            </div>
            
            <button class="btn-interact" style="background:var(--walnut-ink); color:white;" onclick="sendServiceInquiry()">Dispatch Inquiry</button>
        </div>
    </section>


    <footer class="site-footer">
        <div class="footer-logo">Pomelli</div>
        <p>CAIRO • LONDON • PARIS</p>
        <div class="footer-line"></div>
        <p class="legal">&copy; 1922-2025 POMELLI ARCHIVES.</p>
    </footer>


    <div class="modal-screen" id="modal-bg" onclick="closeSheet()"></div>
    
    <div class="archive-sheet" id="detail-sheet">
        <div class="close-circle" onclick="closeSheet()"><i class="fa-solid fa-xmark"></i></div>
        
        <div id="sheet-inject"></div>
        
        </div>
    
    <div class="add-action-bar" id="sticky-bar">
        <button class="btn-add" id="sticky-btn">Add to Trunk</button>
    </div>


    <div class="drawer" id="cart-drawer">
        <div class="drawer-header">
            <i class="fa-solid fa-arrow-left" onclick="toggleCart()" style="font-size:1.5rem; color:#333; cursor:pointer;"></i>
            <div class="card-title" style="margin:0;">The Trunk</div>
            <div></div> </div>
        
        <div class="drawer-content" id="cart-items-area">
            <p style="text-align:center; color:#999; margin-top:50px; font-style:italic;">Your trunk is empty, Sir.</p>
        </div>

        <div class="drawer-footer">
            <div class="form-row">
                <label class="lbl">Delivery Name</label>
                <input type="text" id="order-name" class="inp">
            </div>
            <div class="form-row">
                <label class="lbl">Cairo District</label>
                <select class="inp" id="order-zone">
                    <option value="Zamalek">Zamalek</option>
                    <option value="Maadi">Maadi</option>
                    <option value="New Cairo">New Cairo</option>
                    <option value="Heliopolis">Heliopolis</option>
                    <option value="Sheikh Zayed">Sheikh Zayed</option>
                </select>
            </div>
            <div class="form-row">
                <label class="lbl">Address</label>
                <input type="text" id="order-addr" class="inp" placeholder="Building, Street, Apt">
            </div>
            <button class="btn-add" onclick="checkoutWhatsapp()">Request via WhatsApp</button>
        </div>
    </div>


    <script>
        
        // --- 1. PRELOADER & VIDEO UNLOCKER ---
        function enterManor() {
            const gate = document.getElementById('estate-gate');
            const vid = document.getElementById('bg-video');
            
            // Interaction allows video autoplay on iOS/Android
            gate.classList.add('open');
            vid.play().catch(e => console.log("Autoplay handled via interaction."));
        }

        // --- 2. TABS & SCROLLING ---
        function switchSection(id, btn) {
            // UI Toggle
            document.querySelectorAll('.section-view').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            
            // Activate
            document.getElementById(id).classList.add('active');
            btn.classList.add('active');
            
            // Scroll past video
            window.scrollTo({ top: window.innerHeight * 0.6, behavior: 'smooth' });
        }

        // --- 3. THE ARCHIVE MODULES (Dynamic Content) ---
        
        /* CONTENT: THE CARROT CAKE */
        const carrotContent = `
            <img src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/sovereign-carrot-cake-whole.jpg" class="hero-img-detail">
            
            <div class="module-block">
                <h2 style="font-family:var(--f-display); font-size:2rem; color:var(--cherry-deep); line-height:1; margin-bottom:5px;">The Sovereign Gâteau</h2>
                <p style="font-size:1.2rem; font-style:italic; color:#777;">Grand Rectangular Tier</p>
                
                <div class="spec-grid">
                    <div class="spec-item"><span class="spec-label">Prep Time</span><span class="spec-val">2 Days</span></div>
                    <div class="spec-item"><span class="spec-label">Serves</span><span class="spec-val">16</span></div>
                    <div class="spec-item"><span class="spec-label">Style</span><span class="spec-val">Dense</span></div>
                </div>

                <div class="story-text">
                    Inspired by Truluck's iconic recipe. A breathless tower featuring layers of moist carrot sponge with pineapple and toasted coconut, oven-candied pecans, and a rich brown-butter butterscotch.
                </div>

                <img src="watercolored carrot cake.jpg" class="interaction-img" alt="Watercolor Illustration">

                <div class="notes-paper">
                    <div class="archive-section-title">THE ANATOMY</div>
                    <ul class="ingredient-list">
                        <li><strong>Alchemy:</strong> Browned butter cream cheese frosting.</li>
                        <li><strong>Texture:</strong> Finely grated carrots & toasted coconut.</li>
                        <li><strong>Surprise:</strong> A layer of candied pecans buried inside.</li>
                    </ul>
                    <p style="margin-top:15px; font-style:italic;">"Rustically iced. Best eaten on Day 2."</p>
                </div>
            </div>
        `;

        /* CONTENT: THE STICKY BUNS */
        const bunContent = `
            <img src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/Flow%20Dec%2031%202025.jpeg" class="hero-img-detail">
            
            <div class="module-block">
                <h2 style="font-family:var(--f-display); font-size:2rem; color:var(--cherry-deep); line-height:1; margin-bottom:5px;">Sticky Pecan Buns</h2>
                <p style="font-size:1.2rem; font-style:italic; color:#777;">Morning Tray of 12</p>
                
                <div class="spec-grid">
                    <div class="spec-item"><span class="spec-label">Rolls</span><span class="spec-val">12</span></div>
                    <div class="spec-item"><span class="spec-label">Proof</span><span class="spec-val">3 Hrs</span></div>
                    <div class="spec-item"><span class="spec-label">Heat</span><span class="spec-val">Warm</span></div>
                </div>

                <p style="font-family:var(--f-script); font-size:2rem; color:#aaa; margin-top:20px;">The Pull Apart...</p>
                <img src="sticky_glove.jpg" class="interaction-img" style="border-color:#eee;">

                <div class="story-text" style="font-size:1.1rem; line-height:1.7;">
                    "You can’t have a bad day when it starts with caramel pecan sticky buns."<br>
                    Soft, buttery brioche spirals are filled with cinnamon and baked on top of a bed of boiling caramel. 
                </div>

                <div class="notes-paper">
                    <div class="archive-section-title">METHOD NOTES</div>
                    <div class="method-step">
                        <div class="step-num">1</div>
                        <div><strong>The Dough:</strong> Enriched with milk, egg, and brown butter. Kneaded until pillowy soft.</div>
                    </div>
                    <div class="method-step">
                        <div class="step-num">2</div>
                        <div><strong>The Bed:</strong> A mixture of corn syrup, brown sugar, and pecans creates a glass-like shell once cool.</div>
                    </div>
                </div>
            </div>
        `;

        /* CONTENT: THE ESTATE SOURDOUGH (NEW) */
        const sourdoughContent = `
            <img src="sourdough-outshot.png" class="hero-img-detail">
            
            <div class="module-block">
                <h2 style="font-family:var(--f-display); font-size:2rem; color:var(--cherry-deep); line-height:1; margin-bottom:5px;">The Estate Sourdough</h2>
                <p style="font-size:1.2rem; font-style:italic; color:#777;">Presentation Loaf with Gold Basket</p>
                
                <div class="spec-grid">
                    <div class="spec-item"><span class="spec-label">Origin</span><span class="spec-val">Italian</span></div>
                    <div class="spec-item"><span class="spec-label">Ferment</span><span class="spec-val">48 Hrs</span></div>
                    <div class="spec-item"><span class="spec-label">Crust</span><span class="spec-val">Hard</span></div>
                </div>

                <p style="font-family:var(--f-script); font-size:2rem; color:#aaa; margin-top:20px; text-align:center;">The Crumb...</p>
                <img src="butler-crossection.png" class="interaction-img" style="border-color:#eee;">

                <div class="story-text" style="font-size:1.1rem; line-height:1.7;">
                    Milled from 100% Italian wheat and raised on the "Butler's Private Starter"—a tangy wild yeast culture maintained within the estate archives.
                    <br><br>
                    It arrives not merely in paper, but accompanied by a <strong>Gold Presentation Basket</strong>, designed specifically to impress any dignitary who arrives at your ball.
                </div>

                <div class="story-breaker" style="margin: 30px -25px; padding:0; height:220px; background-image:url('sourdough-wwaterclolor.png'); background-size:cover; box-shadow:none; border:none;"></div>

                <div class="notes-paper">
                    <div class="archive-section-title">TASTING NOTES</div>
                    <ul class="ingredient-list">
                        <li><strong>Exterior:</strong> Shattering, caramel-coloured crust.</li>
                        <li><strong>Interior:</strong> Open crumb, cloud-soft, distinctively tangy.</li>
                        <li><strong>Service:</strong> Toast heavily. Serve with salted butter.</li>
                    </ul>
                </div>
            </div>
        `;

        /* --- SHEET CONTROLS --- */
        
        function showCarrotDetails() {
            document.getElementById('sheet-inject').innerHTML = carrotContent;
            activateStickyBtn("Sovereign Gâteau", 1250);
            openSheet();
        }

        function showBunDetails() {
            document.getElementById('sheet-inject').innerHTML = bunContent;
            activateStickyBtn("Sticky Buns", 850);
            openSheet();
        }

        function showSourdoughDetails() {
            document.getElementById('sheet-inject').innerHTML = sourdoughContent;
            activateStickyBtn("Estate Sourdough", 450);
            openSheet();
        }

        function activateStickyBtn(name, price) {
            const bar = document.getElementById('sticky-bar');
            const btn = document.getElementById('sticky-btn');
            
            btn.innerHTML = `Add to Trunk • ${price} EGP`;
            btn.onclick = function() { addToCart(name, price); };
            
            bar.classList.add('active');
        }

        function openSheet() {
            document.getElementById('modal-bg').classList.add('active');
            document.getElementById('detail-sheet').classList.add('active');
        }

        function closeSheet() {
            document.getElementById('modal-bg').classList.remove('active');
            document.getElementById('detail-sheet').classList.remove('active');
            document.getElementById('sticky-bar').classList.remove('active');
        }


        /* --- 4. CART & WHATSAPP LOGIC --- */
        let cart = [];

        function addToCart(name, price) {
            cart.push({name, price});
            updateBadge();
            closeSheet();
            // Subtle "Cart shake" logic could go here
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            updateBadge();
            renderCart();
        }

        function updateBadge() {
            const b = document.getElementById('cart-count');
            b.innerText = cart.length;
            if(cart.length > 0) b.classList.add('active');
            else b.classList.remove('active');
        }

        function toggleCart() {
            const d = document.getElementById('cart-drawer');
            if(d.classList.contains('open')) {
                d.classList.remove('open');
            } else {
                renderCart();
                d.classList.add('open');
            }
        }

        function renderCart() {
            const area = document.getElementById('cart-items-area');
            if(cart.length === 0) {
                area.innerHTML = '<p style="text-align: center; color: #999; margin-top: 50px;">The trunk is empty, sir.</p>';
                return;
            }
            
            let html = '';
            let total = 0;
            cart.forEach((item, idx) => {
                total += item.price;
                html += `
                <div class="cart-item-row">
                    <div>
                        <div style="font-family: var(--f-display);">${item.name}</div>
                        <div class="rmv-btn" onclick="removeFromCart(${idx})" style="color:var(--cherry-deep); font-size:0.8rem; text-decoration:underline; cursor:pointer;">Remove</div>
                    </div>
                    <div style="font-weight:bold;">${item.price} EGP</div>
                </div>`;
            });
            html += `<div style="text-align:right; font-size:1.2rem; font-family:var(--f-display); margin-top:20px;">Total: ${total} EGP</div>`;
            area.innerHTML = html;
        }

        function checkoutWhatsapp() {
            if(cart.length === 0) return alert("The trunk is empty.");
            
            const name = document.getElementById('order-name').value;
            const zone = document.getElementById('order-zone').value;
            const addr = document.getElementById('order-addr').value;

            if(!name || !addr) return alert("Kindly provide delivery details.");

            let itemString = "";
            let total = 0;
            cart.forEach(i => {
                itemString += `- ${i.name} (${i.price})%0a`;
                total += i.price;
            });

            // Butler Persona
            const msg = `*GOOD EVENING, BUTLER.*%0aI wish to secure provisions:%0a%0a${itemString}%0a*TOTAL: ${total} EGP*%0a%0aDispatch to:${name}%0a${zone}%0a${addr}`;
            
            window.open(`https://wa.me/201024274466?text=${msg}`);
        }

        function sendServiceInquiry() {
            const name = document.getElementById('req-name').value;
            const zone = document.getElementById('req-zone').value;
            const req = document.getElementById('req-details').value;

            if(!name) return alert("Identity required.");

            const msg = `*COMMISSION REQUEST*%0a%0aName: ${name} (${zone})%0aRequest: ${req}`;
            window.open(`https://wa.me/201024274466?text=${msg}`);
        }

    </script>
</body>
</html>
