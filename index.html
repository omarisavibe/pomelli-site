<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#FDFBF7">
    <meta name="description" content="Pomelli Estate Provisions - Private Confections & Artisan Bakery for Cairo Society">
    
    <title>POMELLI | The Estate Archive</title>
    
    <!-- ======================================================================
          LUXURY TYPOGRAPHY SUITE
          ====================================================================== -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,400;1,500;1,600&family=Monsieur+La+Doulaise&family=Playfair+Display:ital@0;1&display=swap" rel="stylesheet">
    
    <!-- ICONS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <style>
        /* ==========================================================================
           1. THE ESTATE DESIGN SYSTEM V3 (FINAL)
           ========================================================================== */
        :root {
            /* --- PALETTE: 'Blood, Gold & Flour' --- */
            --cherry-deep: #5e0b15;       /* Primary Action Color */
            --cherry-bright: #8a1c28;     /* Hover State */
            --walnut-ink: #1f1a18;        /* Primary Text */
            --walnut-light: #4A403A;      /* Secondary Text */
            --cream-paper: #FDFBF7;       /* Main Background */
            --gold-antique: #b08d55;      /* Subtle Borders */
            --gold-leaf: #D4AF37;         /* High Accents */
            
            /* --- TYPOGRAPHY REFERENCES --- */
            --f-display: 'Cinzel', serif;
            --f-body: 'Cormorant Garamond', serif;
            --f-script: 'Monsieur La Doulaise', cursive;
            --f-header: 'Playfair Display', serif;

            /* --- DIMENSIONS & SPACING --- */
            --nav-height: 75px;
            --modal-curve: 24px;
            --btn-radius: 4px;

            /* --- PHYSICS & EFFECTS --- */
            --shadow-card: 0 15px 40px rgba(31, 27, 26, 0.06);
            --ease-luxury: cubic-bezier(0.2, 0.8, 0.2, 1);
            --ease-snap: cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        /* --- GLOBAL RESETS --- */
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        
        html { scroll-behavior: smooth; }
        
        body {
            background-color: var(--cream-paper);
            background-image: url("https://www.transparenttextures.com/patterns/cream-paper.png");
            color: var(--walnut-ink);
            font-family: var(--f-body);
            overflow-x: hidden;
            font-size: 18px; /* High readability */
            padding-bottom: 100px; /* UI Safety Space */
            opacity: 0; 
            animation: dawnRise 1.2s ease forwards;
        }

        h1, h2, h3, h4, button, input { font-weight: normal; }
        
        img { display: block; width: 100%; object-fit: cover; }
        
        button { cursor: pointer; border: none; background: none; }

        @keyframes dawnRise { to { opacity: 1; } }


        /* ==========================================================================
           2. THE IRON GATES (Mobile Preloader & Interaction)
           ========================================================================== */
        #estate-gate {
            position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
            background: #110d0c; z-index: 9999;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: transform 1.5s var(--ease-luxury);
        }
        
        #estate-gate.open { transform: translateY(-100%); pointer-events: none; }

        .gate-logo {
            width: 140px; opacity: 0; filter: invert(1);
            animation: floatUp 1s 0.2s forwards; margin-bottom: 40px;
        }

        .enter-btn {
            background: transparent; border: 1px solid var(--gold-leaf);
            color: var(--gold-leaf); font-family: var(--f-display);
            padding: 18px 50px; font-size: 0.9rem; letter-spacing: 4px;
            text-transform: uppercase; cursor: pointer; position: relative;
            opacity: 0; animation: floatUp 1s 0.8s forwards; transition: 0.3s;
        }
        .enter-btn:active, .enter-btn:hover { background: var(--gold-leaf); color: #000; box-shadow: 0 0 30px rgba(212, 175, 55, 0.3); }

        @keyframes floatUp { from {opacity:0; transform:translateY(20px);} to {opacity:1; transform:translateY(0);} }


        /* ==========================================================================
           3. THE MANOR NAVIGATION
           ========================================================================== */
        .manor-nav {
            position: fixed; top: 0; left: 0; width: 100%; height: 75px;
            background: rgba(253, 251, 247, 0.96); /* High Opacity */
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(197, 160, 89, 0.2);
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 20px; z-index: 5000;
            box-shadow: 0 5px 20px rgba(0,0,0,0.02);
        }

        /* --- LOGO OPTIMIZATION --- */
        .logo-wrap {
            height: 100%; flex-grow: 1; display: flex; 
            align-items: center; justify-content: center;
        }
        
        .nav-logo {
            height: 42px; width: auto; 
            max-width: 180px; 
            object-fit: contain; 
            mix-blend-mode: multiply; /* Crucial for background blend */
            font-family: var(--f-script);
            font-size: 2rem;
            color: var(--walnut-ink);
            text-decoration: none;
        }

        /* --- NAV ACTIONS --- */
        .nav-action {
            flex: 0 0 40px; display: flex; align-items: center; justify-content: center;
            font-size: 1.4rem; color: var(--walnut-ink); cursor: pointer;
        }

        /* --- CART BADGE POSITION FIX --- */
        .cart-container {
            position: relative; /* Container fixes badge position */
            width: 40px; height: 100%;
            display: flex; align-items: center; justify-content: center;
        }

        .cart-badge {
            position: absolute; top: 18px; right: -2px; /* Fine-tuned */
            background: var(--cherry-deep); color: white;
            font-family: var(--f-display); font-size: 0.65rem; font-weight: 700;
            width: 18px; height: 18px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 0 0 2px var(--cream-paper); /* Separation Ring */
            opacity: 0; transform: scale(0); 
            transition: 0.3s var(--ease-snap);
            pointer-events: none;
        }
        .cart-badge.active { opacity: 1; transform: scale(1); }


        /* ==========================================================================
           4. CINEMATIC HEADER (Video Hero)
           ========================================================================== */
        .cinema-frame {
            position: relative; height: 60vh; width: 100%;
            margin-top: 75px; overflow: hidden;
            border-radius: 0 0 32px 32px; /* Deep Curve */
            box-shadow: 0 20px 50px -10px rgba(0,0,0,0.25);
            background: #1F1B1A;
        }

        .cinema-video {
            width: 100%; height: 100%; object-fit: cover;
            filter: brightness(0.65) contrast(1.15) sepia(0.15); /* Film Look */
            transform: scale(1.05); /* Slight Over-scale */
            transition: opacity 1s ease;
        }

        .cinema-overlay {
            position: absolute; bottom: 40px; left: 0; width: 100%;
            padding: 0 25px; z-index: 10;
        }

        .cinema-script {
            font-family: var(--f-script); color: var(--gold-leaf);
            font-size: 3.5rem; line-height: 0.4;
            text-shadow: 0 4px 10px rgba(0,0,0,0.8);
            margin-bottom: 20px; display: block;
        }

        .cinema-title {
            font-family: var(--f-display); color: #fff;
            font-size: 2.2rem; letter-spacing: 2px;
            text-transform: uppercase; margin-top: 15px;
            text-shadow: 0 4px 30px rgba(0,0,0,0.9);
        }


        /* ==========================================================================
           5. INTERACTIVE TABS (Menu Switcher)
           ========================================================================== */
        .tab-scroller {
            position: sticky; top: 75px; 
            background: var(--cream-paper); z-index: 4000;
            padding: 15px 0; border-bottom: 1px solid rgba(0,0,0,0.05);
            /* Scroll Logic */
            white-space: nowrap; overflow-x: auto; -ms-overflow-style: none; scrollbar-width: none;
        }
        .tab-scroller::-webkit-scrollbar { display: none; }

        .tab-track { padding: 0 20px; display: inline-flex; gap: 10px; }

        .tab-btn {
            background: #EDEAE4; 
            padding: 10px 22px; border-radius: 50px; border: 1px solid transparent;
            font-family: var(--f-display); font-size: 0.8rem; letter-spacing: 1px; font-weight: 600;
            color: #666; cursor: pointer; transition: all 0.3s ease;
        }

        .tab-btn.active {
            background: var(--walnut-ink); color: var(--gold-leaf);
            border-color: var(--walnut-ink);
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        }


        /* ==========================================================================
           6. CONTENT CARDS (Product Grid)
           ========================================================================== */
        .section-view { 
            display: none; padding: 25px 20px; min-height: 60vh; 
        }
        .section-view.active { 
            display: block; 
            animation: sectionSlideUp 0.7s var(--ease-luxury); 
        }
        @keyframes sectionSlideUp { from {opacity:0; transform:translateY(30px);} to {opacity:1; transform:translateY(0);} }

        /* The Card Unit */
        .estate-card {
            background: #fff; border-radius: 12px; margin-bottom: 40px;
            box-shadow: var(--shadow-card);
            position: relative; overflow: hidden;
            border: 1px solid rgba(0,0,0,0.03);
            transform: translateZ(0); transition: transform 0.2s;
        }
        .estate-card:active { transform: scale(0.98); }

        .card-img-frame {
            height: 340px; position: relative; overflow: hidden;
        }
        
        .card-img { width: 100%; height: 100%; object-fit: cover; }

        /* Price Badge */
        .price-badge {
            position: absolute; top: 15px; right: 15px;
            background: rgba(255,255,255,0.92); backdrop-filter: blur(8px);
            padding: 8px 14px; border-radius: 6px;
            font-family: var(--f-display); font-weight: 700; color: var(--cherry-deep);
            border: 1px solid var(--gold-antique);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            font-size: 0.9rem; z-index: 2;
        }

        .card-details { padding: 30px 25px; text-align: center; }

        .card-title {
            font-family: var(--f-display); font-size: 1.5rem; 
            margin-bottom: 8px; color: var(--walnut-ink);
        }

        .card-preview {
            font-size: 1.1rem; line-height: 1.6; color: var(--walnut-light); 
            margin-bottom: 25px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
        }

        .btn-interact {
            width: 100%; padding: 16px; background: transparent;
            color: var(--walnut-ink); border: 1px solid var(--gold-antique);
            font-family: var(--f-display); text-transform: uppercase; 
            letter-spacing: 2px; font-size: 0.8rem; border-radius: 4px;
            cursor: pointer; transition: 0.2s;
        }
        .btn-interact:hover, .btn-interact:active {
            background: var(--walnut-ink); color: var(--gold-leaf); border-color: var(--walnut-ink);
        }


        /* ==========================================================================
           7. MODULES (Divider & Concierge)
           ========================================================================== */
        .story-breaker {
            margin: 50px -20px; /* Full Bleed */
            padding: 60px 30px;
            background-color: #2c2826;
            background-image: url('https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/butler-service-caramel-drip.jpg');
            background-size: cover; background-position: center;
            background-blend-mode: overlay;
            text-align: center; border-top: 6px solid #fff; border-bottom: 6px solid #fff;
            box-shadow: inset 0 0 100px rgba(0,0,0,0.4);
        }

        .story-text-box {
            background: rgba(255,255,255,0.96); display: inline-block; padding: 25px 40px;
            border: 1px solid var(--gold-leaf); box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            border-radius: 2px;
        }
        
        .story-text-box h3 { font-family: var(--f-display); margin-bottom: 5px; color: var(--cherry-deep); text-transform: uppercase; letter-spacing: 2px;}


        /* ==========================================================================
           8. FORMS (Concierge)
           ========================================================================== */
        .form-card {
            background: #fff; padding: 40px 25px;
            border-radius: 16px; margin-top: -30px; z-index: 5; position: relative;
            box-shadow: 0 20px 60px rgba(0,0,0,0.08); border: 1px solid rgba(0,0,0,0.05);
        }

        .form-row { margin-bottom: 25px; }
        .lbl {
            display: block; font-family: var(--f-display); 
            font-size: 0.75rem; letter-spacing: 2px; color: #999; 
            text-transform: uppercase; margin-bottom: 10px;
        }
        .inp {
            width: 100%; padding: 15px; border: 1px solid #ddd; border-radius: 4px;
            font-family: var(--f-body); font-size: 1.1rem; color: #333;
            background: #fafafa; transition: border 0.3s;
        }
        .inp:focus { border-color: var(--cherry-deep); background: white; }
        
        select.inp {
            appearance: none; background: #fafafa url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M7%207l5%205%205-5%22%20stroke%3D%22%23999%22%20fill%3D%22none%22%2F%3E%3C%2Fsvg%3E') no-repeat right 15px center;
        }


        /* ==========================================================================
           9. ARCHIVE SHEET (Detailed Modal)
           ========================================================================== */
        .modal-screen {
            position: fixed; inset: 0; background: rgba(31, 26, 24, 0.7); backdrop-filter: blur(6px);
            z-index: 6000; opacity: 0; pointer-events: none; transition: 0.4s;
        }
        .modal-screen.active { opacity: 1; pointer-events: auto; }

        .archive-sheet {
            position: fixed; bottom: 0; left: 0; width: 100%; height: 92vh;
            background: #FFF; border-radius: 20px 20px 0 0; z-index: 6100;
            transform: translateY(100%); transition: transform 0.5s var(--ease-luxury);
            overflow-y: scroll; padding-bottom: 120px;
            /* Inner texture */
            background-image: url("https://www.transparenttextures.com/patterns/cream-paper.png");
        }
        .archive-sheet.active { transform: translateY(0); }

        .close-circle {
            position: absolute; top: 20px; right: 20px; width: 45px; height: 45px;
            background: white; border-radius: 50%; box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            display: flex; align-items: center; justify-content: center; z-index: 100;
            color: var(--walnut-ink); transition: 0.3s; cursor: pointer; font-size: 1.2rem;
        }
        .close-circle:hover { color: var(--cherry-deep); transform: rotate(90deg); }

        .hero-img-detail { height: 400px; width: 100%; object-fit: cover; }

        .module-block { padding: 40px 25px; }

        /* SPECIFICATION GRID */
        .spec-grid {
            display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;
            margin: 30px 0; border-top: 1px solid var(--gold-antique); border-bottom: 1px solid var(--gold-antique); padding: 20px 0;
        }
        .spec-item { text-align: center; border-right: 1px solid #ddd; }
        .spec-item:last-child { border: none; }
        .spec-label { font-size: 0.6rem; text-transform: uppercase; color: #888; letter-spacing: 1px; display: block; margin-bottom: 5px; font-family: var(--f-display); }
        .spec-val { font-family: var(--f-display); font-size: 1.1rem; color: var(--cherry-deep); font-weight: 700; }

        /* STORY TEXT */
        .story-text {
            font-size: 1.1rem; line-height: 1.8; color: #444; margin-bottom: 30px;
        }

        /* PAPER EFFECT FOR NOTES */
        .notes-paper {
            margin: 30px -10px; padding: 30px;
            background: #fff; border: 1px solid #e0dccc;
            box-shadow: inset 0 0 60px rgba(0,0,0,0.02);
            font-size: 1.05rem; line-height: 1.8; position: relative;
        }
        .notes-paper::before {
            content: 'FROM THE KITCHEN ARCHIVE';
            position: absolute; top: -10px; left: 50%; transform: translateX(-50%);
            background: var(--cherry-deep); color: white;
            font-family: var(--f-display); font-size: 0.7rem; padding: 4px 12px; letter-spacing: 1px;
        }
        
        .ingredient-list li { margin-bottom: 8px; border-bottom: 1px dashed #e0e0e0; padding-bottom: 8px; list-style: none; }
        
        .method-step { display: flex; gap: 15px; margin-bottom: 20px; }
        .step-num { 
            flex: 0 0 25px; height: 25px; background: var(--walnut-ink); color: white;
            font-family: var(--f-display); border-radius: 50%; font-size: 0.8rem;
            display: flex; align-items: center; justify-content: center; 
        }

        /* Interaction Visuals */
        .interaction-img {
            margin: 30px 0; border: 8px solid white; width: 100%;
            box-shadow: 0 10px 40px rgba(0,0,0,0.12); 
            transform: rotate(-1deg);
        }

        /* Floating Add Button */
        .add-action-bar {
            position: fixed; bottom: 0; left: 0; width: 100%;
            padding: 20px; background: rgba(255,255,255,0.95);
            border-top: 1px solid rgba(0,0,0,0.05); z-index: 6200;
            display: none; animation: floatUpBtn 0.4s ease;
        }
        .add-action-bar.active { display: block; }
        @keyframes floatUpBtn { from{transform:translateY(100%);} to{transform:translateY(0);} }

        .btn-add {
            width: 100%; padding: 18px; border-radius: 4px; border: none;
            background: var(--cherry-deep); color: white;
            font-family: var(--f-display); letter-spacing: 2px; text-transform: uppercase;
            box-shadow: 0 10px 30px rgba(138, 28, 40, 0.4);
            display: flex; justify-content: space-between; padding: 18px 30px;
        }


        /* ==========================================================================
           10. THE TRUNK (Checkout)
           ========================================================================== */
        .drawer {
            position: fixed; top: 0; right: 0; width: 100%; height: 100%;
            background: #FDFBF7; z-index: 7000;
            transform: translateX(100%); transition: transform 0.5s var(--ease-luxury);
            display: flex; flex-direction: column;
            box-shadow: -20px 0 100px rgba(0,0,0,0.3);
        }
        .drawer.open { transform: translateX(0); }

        .drawer-header {
            padding: 25px; border-bottom: 1px solid rgba(0,0,0,0.05);
            display: flex; justify-content: space-between; align-items: center;
            background: white; height: 75px;
        }
        
        .drawer-content { flex: 1; padding: 25px; overflow-y: auto; }
        
        .cart-item-row {
            padding-bottom: 15px; margin-bottom: 15px; border-bottom: 1px dashed #ccc;
            display: flex; justify-content: space-between; align-items: center;
        }

        .drawer-footer {
            padding: 30px 25px 50px; background: white; border-top: 1px solid #eee;
        }


        /* ==========================================================================
           11. FOOTER (Refined & Branded)
           ========================================================================== */
        .site-footer {
            background: #111; color: #888; padding: 60px 20px 40px;
            text-align: center; font-size: 0.9rem;
        }
        
        .footer-logo-img {
            height: 70px; width: auto; margin: 0 auto 20px;
            filter: invert(1) drop-shadow(0 0 5px #b08d55); /* Simulate Gold if white png */
        }
        
        .social-row {
            display: flex; justify-content: center; gap: 30px; margin: 30px 0;
        }
        .social-icon { color: var(--gold-antique); font-size: 1.5rem; transition: 0.3s; }
        .social-icon:hover { color: #fff; transform: scale(1.1); }

        .footer-links { font-family: var(--f-display); font-size: 0.7rem; letter-spacing: 1px; margin-bottom: 20px;}
        
        .legal {
            font-size: 0.7rem; letter-spacing: 1px; text-transform: uppercase;
            border-top: 1px solid #222; padding-top: 25px; margin-top: 25px; color: #555;
        }

    </style>
</head>
<body>

    <!-- ========================
         1. PRELOADER & GATES
         ======================== -->
    <div id="estate-gate">
        <h1 class="gate-logo" style="color:var(--gold-leaf); font-family:var(--f-script); font-size:3rem;">Pomelli</h1>
        <!-- FIXED: Button now has onclick directly and type="button" -->
        <button class="enter-btn" type="button" onclick="enterManor()">Enter The Estate</button>
    </div>


    <!-- ========================
         2. NAVIGATION
         ======================== -->
    <header class="manor-nav">
        <!-- Menu Icon -->
        <div class="nav-action">
            <i class="fa-solid fa-bars" onclick="alert('The Butler is organizing the inventory.')"></i>
        </div>
        
        <!-- Logo -->
        <div class="logo-wrap">
            <a href="#" class="nav-logo">Pomelli</a>
        </div>

        <!-- Fixed Cart Position -->
        <div class="nav-action cart-container" onclick="toggleCart()">
            <i class="fa-solid fa-suitcase"></i>
            <div class="cart-badge" id="cart-count">0</div>
        </div>
    </header>


    <!-- ========================
         3. CINEMATIC HEADER
         ======================== -->
    <div class="cinema-frame">
        <!-- Video handles logic via JS interaction -->
        <video id="bg-video" class="cinema-video" muted loop playsinline webkit-playsinline poster="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/sovereign-carrot-cake-whole.jpg">
            <source src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/asembeling%20carrot%20cake%20video.mp4" type="video/mp4">
        </video>
        <div class="cinema-overlay">
            <span class="cinema-script">Private Provisions</span>
            <h1 class="cinema-title">Winter Archives</h1>
        </div>
    </div>


    <!-- ========================
         4. MENU TABS
         ======================== -->
    <div class="tab-scroller">
        <div class="tab-track">
            <button class="tab-btn active" onclick="switchSection('cakes', this)">Grand Gâteaux</button>
            <button class="tab-btn" onclick="switchSection('bakery', this)">Estate Bakery</button>
            <button class="tab-btn" onclick="switchSection('buns', this)">Morning Goods</button>
            <button class="tab-btn" onclick="switchSection('concierge', this)">Butler Service</button>
        </div>
    </div>


    <!-- ========================
         SECTION: GRAND GATEAUX
         ======================== -->
    <section id="cakes" class="section-view active">
        <!-- CARROT CAKE -->
        <div class="estate-card">
            <div class="card-img-frame">
                <span class="price-badge">1250 EGP</span>
                <img src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/sovereign-carrot-cake-whole.jpg" class="card-img" alt="Carrot Cake">
            </div>
            <div class="card-details">
                <h2 class="card-title">The Sovereign Gâteau</h2>
                <p class="card-preview">Dense heritage carrot sponge, candied pecans, and brown-butter cream cheese.</p>
                <button class="btn-interact" onclick="showCarrotDetails()">Access Archive Entry</button>
            </div>
        </div>

        <!-- SLICE -->
        <div class="estate-card">
            <div class="card-img-frame">
                <span class="price-badge">140 EGP</span>
                <img src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/carrot-cake-slice-art-deco-plate.jpg" class="card-img" alt="Slice">
            </div>
            <div class="card-details">
                <h2 class="card-title">The Salon Slice</h2>
                <p class="card-preview">A generous single portion. Gold-plated and drizzled with warm sauce.</p>
                <button class="btn-interact" onclick="addToCart('Salon Slice', 140)">Add Single Serving</button>
            </div>
        </div>
    </section>


    <!-- ========================
         SECTION: ESTATE BAKERY (NEW)
         ======================== -->
    <section id="bakery" class="section-view">
        <div class="estate-card">
            <div class="card-img-frame">
                <span class="price-badge">450 EGP</span>
                <img src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/topview.png" class="card-img" alt="Sourdough Loaf" onerror="this.src='https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/sovereign-carrot-cake-whole.jpg'">
            </div>
            <div class="card-details">
                <h2 class="card-title">Estate Hearth Sourdough</h2>
                <p class="card-preview">Tangy 100% Italian flour loaf. Crusty exterior, pillow-soft interior. Includes gold basket.</p>
                <button class="btn-interact" onclick="showSourdoughDetails()">View Bakery Archive</button>
            </div>
        </div>
    </section>


    <!-- ========================
         SECTION: MORNING GOODS
         ======================== -->
    <section id="buns" class="section-view">
        <div class="estate-card">
            <div class="card-img-frame">
                <span class="price-badge">850 EGP</span>
                <img src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/Flow%20Dec%2031%202025.jpeg" class="card-img" alt="Sticky Buns">
            </div>
            <div class="card-details">
                <h2 class="card-title">Sticky Pecan Buns</h2>
                <p class="card-preview">A tray of 12 brioche spirals bathing in a bed of boiling caramel.</p>
                <button class="btn-interact" onclick="showBunDetails()">View The Romance</button>
            </div>
        </div>

        <!-- FOLKLORE BREAK -->
        <div class="story-breaker">
            <div class="story-text-box">
                <h3>Packaging Folklore</h3>
                <p style="font-style: italic; color:#555;">No plastic. Arriving in Beatrix Potter illustrated boxes.</p>
            </div>
        </div>
    </section>


    <!-- ========================
         SECTION: CONCIERGE FORM
         ======================== -->
    <section id="concierge" class="section-view">
        <img src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/butler-service-caramel-drip.jpg" style="border-radius:12px; margin-bottom:25px; filter:sepia(0.2); width:100%; height:250px; object-fit:cover;" alt="Butler Service">
        
        <div class="form-card">
            <h2 class="card-title" style="margin-bottom:10px;">Commission The Butler</h2>
            <p style="text-align:center; color:#777; margin-bottom:25px; font-size:0.95rem;">Private Event Inquiries & Custom Commissions</p>
            
            <div class="form-row">
                <label class="lbl">Client Title</label>
                <input type="text" class="inp" id="req-name" placeholder="e.g. Lady Sarah">
            </div>
            <div class="form-row">
                <label class="lbl">Cairo District</label>
                <select class="inp" id="req-zone">
                    <option>Zamalek</option>
                    <option>Garden City</option>
                    <option>Maadi</option>
                    <option>New Cairo</option>
                    <option>Sheikh Zayed</option>
                </select>
            </div>
            <div class="form-row">
                <label class="lbl">Nature of Inquiry</label>
                <textarea class="inp" id="req-detail" style="min-height:100px;" placeholder="I require tableside service for..."></textarea>
            </div>
            
            <button class="btn-interact" style="background:var(--walnut-ink); color:#fff;" onclick="submitService()">Dispatch Communiqué</button>
        </div>
    </section>


    <!-- ========================
         REVISED FOOTER
         ======================== -->
    <footer class="site-footer">
        <h2 style="font-family:var(--f-script); color:var(--gold-leaf); font-size:2rem; margin-bottom:20px;">Pomelli</h2>
        
        <div class="social-row">
            <a href="#" class="social-icon"><i class="fa-brands fa-instagram"></i></a>
            <a href="#" class="social-icon"><i class="fa-brands fa-whatsapp"></i></a>
        </div>

        <div class="footer-links">
            <span>CAIRO</span> • <span>ESTATES</span> • <span>PRIVACY</span>
        </div>

        <p class="legal">&copy; 1922-2025 POMELLI ESTATE ARCHIVES.</p>
    </footer>


    <!-- ==========================================================
         INTERACTIVE ARCHIVE (Detail Modal)
         ========================================================== -->
    <div class="modal-screen" id="modal-bg" onclick="closeSheet()"></div>
    
    <div class="archive-sheet" id="detail-sheet">
        <div class="sheet-header">
            <div class="close-circle" onclick="closeSheet()"><i class="fa-solid fa-xmark"></i></div>
        </div>
        
        <!-- JS INJECTS CONTENT HERE -->
        <div id="sheet-inject"></div>
        
        <!-- Padding for Sticky Button -->
        <div style="height:100px;"></div>
    </div>
    
    <div class="add-action-bar" id="sticky-bar">
        <button class="btn-add" id="sticky-btn">
            <span id="st-text">Add to Trunk</span>
            <span id="st-price">0 EGP</span>
        </button>
    </div>


    <!-- ==========================================================
         THE TRUNK (Cart Drawer)
         ========================================================== -->
    <div class="drawer" id="cart-drawer">
        <div class="drawer-header">
            <div class="nav-action" onclick="toggleCart()"><i class="fa-solid fa-arrow-left"></i></div>
            <div style="font-family:var(--f-display); font-size:1.2rem;">The Trunk</div>
            <div style="width:40px;"></div>
        </div>
        
        <div class="drawer-content" id="cart-items">
            <p style="text-align:center; color:#999; margin-top:50px;">The trunk is empty, Sir.</p>
        </div>

        <div class="drawer-footer">
            <p style="margin-bottom:15px; font-family:var(--f-display); font-size:0.8rem; letter-spacing:1px; color:var(--cherry-deep);">DESTINATION</p>
            <div class="form-row">
                <input type="text" id="order-name" class="inp" placeholder="Recipient Name">
            </div>
            <!-- DROPDOWN REQUESTED -->
            <div class="form-row">
                <select class="inp" id="order-zone">
                    <option value="" disabled selected>Select District</option>
                    <option value="Zamalek">Zamalek</option>
                    <option value="Maadi">Maadi</option>
                    <option value="Garden City">Garden City</option>
                    <option value="New Cairo">New Cairo / Tagamoa</option>
                    <option value="Sheikh Zayed">Sheikh Zayed / 6 Oct</option>
                    <option value="Heliopolis">Heliopolis</option>
                </select>
            </div>
            <div class="form-row">
                <input type="text" id="order-addr" class="inp" placeholder="Building & Street Address">
            </div>
            
            <button class="btn-add" onclick="checkoutWhatsapp()">Request via WhatsApp</button>
        </div>
    </div>


    <!-- ==========================================================
         JAVASCRIPT LOGIC ENGINE
         ========================================================== -->
    <script>
        
        // --- 1. ENTRY SEQUENCE ---
        function enterManor() {
            // IMMEDIATE ACTION: Lift the gate visually
            document.getElementById('estate-gate').classList.add('open');
            
            const v = document.getElementById('bg-video');
            v.muted = true;
            
            // Try to play video, but don't stop the experience if it fails
            var playPromise = v.play();
            
            if (playPromise !== undefined) {
                playPromise.then(_ => {
                    // Automatic playback started!
                })
                .catch(error => {
                    // Auto-play was prevented
                    console.log('Video autoplay prevented by browser policy - this is normal.');
                });
            }
        }

        // --- 2. TABS SWITCHER ---
        function switchSection(id, btn) {
            // UI Clear
            document.querySelectorAll('.section-view').forEach(e=>e.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(e=>e.classList.remove('active'));
            
            // Set Active
            document.getElementById(id).classList.add('active');
            btn.classList.add('active');
            
            // Smooth Scroll Adjustment
            const offset = 75; // header height
            window.scrollTo({top: window.innerHeight * 0.6 - offset, behavior:'smooth'});
        }

        // --- 3. ARCHIVE CONTENT DATA (Specific & Rich) ---
        
        // CARROT CAKE
        const carrotContent = `
            <img src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/sovereign-carrot-cake-whole.jpg" class="hero-img-detail">
            <div class="module-block">
                <h2 style="font-family:var(--f-display); font-size:2rem; line-height:1; margin-bottom:5px; color:var(--cherry-deep);">The Sovereign Gâteau</h2>
                <p style="font-size:1.1rem; color:#777; font-style:italic;">Grand Rectangular Tier</p>
                
                <div class="spec-grid">
                    <div class="spec-item"><span class="spec-label">Serves</span><span class="spec-val">16</span></div>
                    <div class="spec-item"><span class="spec-label">Time</span><span class="spec-val">2 Days</span></div>
                    <div class="spec-item"><span class="spec-label">Weight</span><span class="spec-val">Heavy</span></div>
                </div>

                <div class="story-text">
                    Inspired by the Truluck's legend. This is not a sponge; it is an institution. A breathless tower featuring layers of moist carrot sponge with crushed pineapple and toasted coconut, separating tiers of brown-butter cream cheese.
                </div>

                <img src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/watercolored%20carrot%20cake.jpg" class="interaction-img" alt="Illustration" onerror="this.style.display='none'">

                <div class="notes-paper">
                    <div class="lbl" style="text-align:center; border-bottom:1px solid #ddd; padding-bottom:5px; margin-bottom:15px;">Kitchen Archives</div>
                    <ul class="ingredient-list">
                        <li><strong>Inclusion:</strong> Oven-candied pecans buried in the frosting.</li>
                        <li><strong>Sauce:</strong> Salted Brown Butter Butterscotch drizzle.</li>
                        <li><strong>Frosting:</strong> Cream cheese whipped with browned butter.</li>
                    </ul>
                    <p style="margin-top:15px; font-size:0.9rem; font-style:italic;">"The result improves as it sits. Best eaten on Day 2."</p>
                </div>
            </div>`;

        // STICKY BUNS
        const bunContent = `
            <img src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/Flow%20Dec%2031%202025.jpeg" class="hero-img-detail">
            <div class="module-block">
                <h2 style="font-family:var(--f-display); font-size:2rem; line-height:1; margin-bottom:5px; color:var(--cherry-deep);">Sticky Pecan Buns</h2>
                <p style="font-size:1.1rem; color:#777; font-style:italic;">Morning Tray of 12</p>
                
                <div class="spec-grid">
                    <div class="spec-item"><span class="spec-label">Count</span><span class="spec-val">12</span></div>
                    <div class="spec-item"><span class="spec-label">Proof</span><span class="spec-val">3 Hrs</span></div>
                    <div class="spec-item"><span class="spec-label">Style</span><span class="spec-val">Gooey</span></div>
                </div>

                <p style="font-family:var(--f-script); font-size:2.5rem; text-align:center; color:#aaa; margin:20px 0;">The Pull Apart...</p>
                <img src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/sticky_glove.jpg" class="interaction-img" onerror="this.style.display='none'">

                <div class="story-text">
                    "You can’t have a bad day when it starts with caramel pecan sticky buns." Soft, buttery brioche spirals are filled with cinnamon and baked on top of a bed of boiling caramel. 
                </div>

                <div class="notes-paper">
                    <div class="method-step">
                        <div class="step-num">1</div>
                        <div><strong>The Bed:</strong> A mixture of corn syrup, brown sugar, and pecans creates a glass-like shell once cool.</div>
                    </div>
                    <div class="method-step">
                        <div class="step-num">2</div>
                        <div><strong>The Rise:</strong> Double proofed for a pillowy, soft gluten structure.</div>
                    </div>
                </div>
            </div>`;

        // ESTATE SOURDOUGH (New Listing)
        const sourdoughContent = `
            <img src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/topview.png" class="hero-img-detail" onerror="this.src='https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/sovereign-carrot-cake-whole.jpg'">
            <div class="module-block">
                <h2 style="font-family:var(--f-display); font-size:2rem; line-height:1; margin-bottom:5px; color:var(--cherry-deep);">Estate Hearth Sourdough</h2>
                <p style="font-size:1.1rem; color:#777; font-style:italic;">Artisan Boule with Gold Basket</p>
                
                <div class="spec-grid">
                    <div class="spec-item"><span class="spec-label">Ferment</span><span class="spec-val">36 Hrs</span></div>
                    <div class="spec-item"><span class="spec-label">Flour</span><span class="spec-val">Italian</span></div>
                    <div class="spec-item"><span class="spec-label">Origin</span><span class="spec-val">Cairo</span></div>
                </div>

                <div class="story-text">
                    A loaf of aggressive crust and pillow-soft crumb. Made with 100% imported Italian flour, stone-milled locally. Our starter is fed daily by the Butler.
                </div>

                <img src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/butler-crossection.png" class="interaction-img" alt="Sourdough Crumb" onerror="this.style.display='none'">

                <div class="notes-paper">
                    <img src="https://rfwlaucrlfohxrrspxmx.supabase.co/storage/v1/object/public/pomelli-gallery/sourdough-watercolor.png" style="width:100px; margin:0 auto 10px; display:block;" onerror="this.style.display='none'">
                    <p style="text-align:center; font-style:italic;">"Includes the signature Gold Presentation Basket for immediate serving at your estate."</p>
                    <hr style="border:0; border-bottom:1px solid #ddd; margin:15px 0;">
                    <ul class="ingredient-list">
                        <li>Tangy, complex flavor profile.</li>
                        <li>Blistered, dark-baked crust.</li>
                        <li>High hydration interior.</li>
                    </ul>
                </div>
            </div>`;


        /* --- SHEET LOGIC --- */
        function launchSheet(html, name, price) {
            document.getElementById('sheet-inject').innerHTML = html;
            
            const btnText = document.getElementById('st-text');
            const btnPrice = document.getElementById('st-price');
            const stickyBtn = document.getElementById('sticky-btn');
            
            btnText.innerText = "Add to Trunk";
            btnPrice.innerText = price + " EGP";
            
            stickyBtn.onclick = function() { addToCart(name, price); };

            document.getElementById('modal-bg').classList.add('active');
            document.getElementById('detail-sheet').classList.add('active');
            document.getElementById('sticky-bar').classList.add('active');
        }

        function showCarrotDetails() { launchSheet(carrotContent, "Sovereign Gâteau", 1250); }
        function showBunDetails() { launchSheet(bunContent, "Sticky Pecan Buns", 850); }
        function showSourdoughDetails() { launchSheet(sourdoughContent, "Hearth Sourdough", 450); } // Priced at 450 due to Basket

        function closeSheet() {
            document.getElementById('modal-bg').classList.remove('active');
            document.getElementById('detail-sheet').classList.remove('active');
            document.getElementById('sticky-bar').classList.remove('active');
        }


        /* --- 4. CART & MESSAGING LOGIC (Butler Persona) --- */
        let cart = [];

        function addToCart(name, price) {
            cart.push({name, price});
            updateBadge();
            closeSheet();
            // Optional: Subtle haptic visual on suitcase
            const suitcase = document.querySelector('.cart-container');
            suitcase.style.transform = 'scale(1.1)';
            setTimeout(()=> suitcase.style.transform='scale(1)', 200);
            
            // Auto open cart for feedback
            setTimeout(toggleCart, 300);
        }

        function removeCart(idx) {
            cart.splice(idx,1);
            updateBadge();
            renderCart();
        }

        function updateBadge() {
            const b = document.getElementById('cart-count');
            b.innerText = cart.length;
            if(cart.length>0) b.classList.add('active'); else b.classList.remove('active');
        }

        function toggleCart() {
            document.getElementById('cart-drawer').classList.toggle('open');
            renderCart();
        }

        function renderCart() {
            const el = document.getElementById('cart-items');
            
            // Check if trunk is empty
            if(cart.length === 0) { 
                el.innerHTML = "<p style='text-align:center; color:#aaa; margin-top:50px; font-style:italic;'>The trunk is empty, Sir.</p>"; 
                return;
            }
            
            let html = ''; 
            let t = 0;
            
            // Loop through cart items
            cart.forEach((i, x) => {
                t += i.price;
                html += `<div class="cart-item-row">
                    <div>
                        <div style="font-family:var(--f-display); font-size:1rem;">${i.name}</div>
                        <div onclick="removeCart(${x})" style="color:var(--cherry-deep); font-size:0.75rem; text-decoration:underline; cursor:pointer; margin-top:4px;">Remove Provision</div>
                    </div>
                    <div style="font-weight:700;">${i.price} EGP</div>
                </div>`;
            });
            
            // Add Total
            html += `<div style="text-align:right; font-family:var(--f-display); font-size:1.3rem; margin-top:25px; border-top:1px solid var(--gold-antique); padding-top:15px; letter-spacing:1px;">
                TOTAL: ${t} EGP
            </div>`;
            
            el.innerHTML = html;
        }

        // --- 5. WHATSAPP & SERVICE INTEGRATION ---
        
        function checkoutWhatsapp() {
            if (cart.length === 0) {
                alert("The trunk is empty, Sir.");
                return;
            }

            const name = document.getElementById('order-name').value;
            const zone = document.getElementById('order-zone').value;
            const addr = document.getElementById('order-addr').value;

            if(!name || !zone || !addr) {
                alert("The Butler requires your destination details.");
                return;
            }

            let msg = `*POMELLI ESTATE ORDER Request*\n`;
            msg += `------------------\n`;
            msg += `Client: ${name}\n`;
            msg += `District: ${zone}\n`;
            msg += `Address: ${addr}\n`;
            msg += `------------------\n`;
            
            let total = 0;
            cart.forEach(i => {
                msg += `• ${i.name} - ${i.price} EGP\n`;
                total += i.price;
            });
            
            msg += `------------------\n`;
            msg += `*TOTAL: ${total} EGP*\n`;
            msg += `Please confirm availability.`;

            // Encode and Open
            const url = `https://wa.me/?text=${encodeURIComponent(msg)}`;
            window.open(url, '_blank');
        }

        function submitService() {
            const name = document.getElementById('req-name').value;
            const zone = document.getElementById('req-zone').value;
            const detail = document.getElementById('req-detail').value;

            if(!name || !detail) {
                alert("Please provide details for your inquiry.");
                return;
            }

            let msg = `*BUTLER SERVICE COMMISSION*\n`;
            msg += `Client: ${name}\n`;
            msg += `District: ${zone}\n`;
            msg += `Inquiry: ${detail}`;

            const url = `https://wa.me/?text=${encodeURIComponent(msg)}`;
            window.open(url, '_blank');
        }

    </script>
</body>
</html>
